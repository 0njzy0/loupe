<script type='bootstrap' id='bootstrap'>
var _timerId = 0;
console.log('TIMEOUT' + setTimeout);
var _setTimeout = this.setTimeout;
var setTimeout = function (cb, time) {
  _timerId++;
  postMessage("timer:queued:" + _timerId);
  _setTimeout(function () {
    postMessage("timer:processing:" + _timerId);
    cb();
    postMessage("timer:processed:" + _timerId);
  }, time);
};

var $ = function (sel) {
  return {
    on: function (event, cb) {
      addEventListener('message', function (e) {
        var data = e.data;
        if (e.data.sel === sel && e.data.event === event) {
          cb(e.data.eventData);
        }
      });
    }
  };
};
</script>

<code>
<pre id=code>

setTimeout(function () {
  console.log('Queued');
}, 1000);


$('button').on('click', function () {
    console.log('Hello');
});


function onEach (el) {
  console.log(el);
}

function a (array) {
  array.forEach(onEach);
}


a([1,2,3]);
console.log('2');
console.log('3');
</pre>
<code>
<button>go!</button>

<div id='colored'>

</div>

<pre id=instrumented></pre>


<script src='escodegen.js'></script>
<script src='trace.js'></script>

<style>
  #code, #colored, #console {
    margin: 20px;
    padding: 5px;
    border: 1px gray solid;
    font-family: monospace;
  }

  #console {
    margin-top: 80px;
  }

</style>
